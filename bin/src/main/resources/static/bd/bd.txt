DROP DATABASE IF EXISTS VENTAS_T5WB;
CREATE DATABASE VENTAS_T5WB;
USE VENTAS_T5WB;

CREATE TABLE tbl_UBIGEO
(
	IDE_UBI CHAR(6) PRIMARY KEY,    -- UBIGEO
    COD_DPT CHAR(2) NOT NULL,       -- CODIGO DEPARTAMENTO
    COD_PRO CHAR(2) NOT NULL,       -- CODIGO PROVINCIA
    COD_DIS CHAR(2) NOT NULL,       -- CODIGO DISTRITO
    DES_DPT VARCHAR(25) NOT NULL,   -- DESCRIPCION DEPARTAMENTO
    DES_PRO VARCHAR(100) NOT NULL,  -- DESCRIPCION PROVINCIA
    DES_DIS VARCHAR(100) NOT NULL   -- DESCRIPCION DISTRITO
);
INSERT INTO tbl_UBIGEO VALUES ('150114', '15','01','14', 'LIMA','LIMA','LA MOLINA');
INSERT INTO tbl_UBIGEO VALUES ('150140', '15','01','40', 'LIMA','LIMA','SANTIAGO DE SURCO');

CREATE TABLE tbl_UNIDAD_MEDIDA
(
	IDE_UME INT AUTO_INCREMENT PRIMARY KEY,  -- IDE UNIDAD DE MEDIDA
    DES_UME VARCHAR(20)                      -- DESCRIPCION
);
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'GRAMO');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'KILOGRAMO');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'PAQUETE');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'TONELADA');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'DOCENA');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'GALON');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'LATA');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'LITRO');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'ONZA');
INSERT INTO tbl_UNIDAD_MEDIDA VALUES (NULL, 'UNIDAD');

CREATE TABLE tbl_TIPO_DOCUMENTO
(
	IDE_TDO INT AUTO_INCREMENT PRIMARY KEY, -- IDE TIPO DOCUMENTO IDENTIDAD
    DES_TDO VARCHAR(35) NOT NULL            -- DESCRIPCION
);
INSERT INTO tbl_TIPO_DOCUMENTO VALUES (NULL, 'DOCUMENTO NACIONAL DE IDENTIDAD');
INSERT INTO tbl_TIPO_DOCUMENTO VALUES (NULL, 'CARNET EXTRANJERIA');
INSERT INTO tbl_TIPO_DOCUMENTO VALUES (NULL, 'PASAPORTE');
INSERT INTO tbl_TIPO_DOCUMENTO VALUES (NULL, 'OTRO');

CREATE TABLE tbl_TIPO_USUARIO
(
	IDE_TUS INT AUTO_INCREMENT PRIMARY KEY, -- IDE TIPO USUARIO
    DES_TUS VARCHAR(20) NOT NULL            -- DESCRIPCION
);
INSERT INTO tbl_TIPO_USUARIO VALUES (NULL, 'ADMINISTRADOR');
INSERT INTO tbl_TIPO_USUARIO VALUES (NULL, 'USUARIO');
INSERT INTO tbl_TIPO_USUARIO VALUES (NULL, 'GERENTE');

CREATE TABLE tbl_TIPO_COMPROBANTE
(
	IDE_TCO INT AUTO_INCREMENT PRIMARY KEY, -- IDE TIPO COMPROBANTE
    DES_TCO VARCHAR(20) NOT NULL            -- DESCRIPCION
);
INSERT INTO tbl_TIPO_COMPROBANTE VALUES (NULL, 'BOLETA');
INSERT INTO tbl_TIPO_COMPROBANTE VALUES (NULL, 'FACTURA');
INSERT INTO tbl_TIPO_COMPROBANTE VALUES (NULL, 'NOTA DE CREDITO');
INSERT INTO tbl_TIPO_COMPROBANTE VALUES (NULL, 'NOTA DE DEBITO');
INSERT INTO tbl_TIPO_COMPROBANTE VALUES (NULL, 'GUIA DE REMISION');

CREATE TABLE tbl_TIPO_PAGO
(
	IDE_TPA INT AUTO_INCREMENT PRIMARY KEY, -- IDE TIPO PAGO
    DES_TPA VARCHAR(30)                     -- DESCRIPCION
);
INSERT INTO tbl_TIPO_PAGO VALUES (NULL, 'EFECTIVO');
INSERT INTO tbl_TIPO_PAGO VALUES (NULL, 'TARJETA DEBITO');
INSERT INTO tbl_TIPO_PAGO VALUES (NULL, 'TARJETA CREDITO');
INSERT INTO tbl_TIPO_PAGO VALUES (NULL, 'TRANSFERENCIA');
INSERT INTO tbl_TIPO_PAGO VALUES (NULL, 'YAPE');
INSERT INTO tbl_TIPO_PAGO VALUES (NULL, 'PLIN');

CREATE TABLE tbl_TIPO_ENTREGA
(
	IDE_TEN INT AUTO_INCREMENT PRIMARY KEY, -- IDE TIPO ENTREGA
    DES_TEN VARCHAR(20)                     -- DESCRIPCION
);
INSERT INTO tbl_TIPO_ENTREGA VALUES (NULL, 'RECOJO EN TIENDA');
INSERT INTO tbl_TIPO_ENTREGA VALUES (NULL, 'DELIVERY');

CREATE TABLE tbl_CARGO
(
	IDE_CAR INT AUTO_INCREMENT PRIMARY KEY, -- IDE CARGO
    DES_CAR VARCHAR(30)                     -- DESCRIPCION
);
INSERT INTO tbl_CARGO VALUES (NULL, 'PRESIDENTE');
INSERT INTO tbl_CARGO VALUES (NULL, 'VICE PRESIDENTE');
INSERT INTO tbl_CARGO VALUES (NULL, 'DIRECTOR');
INSERT INTO tbl_CARGO VALUES (NULL, 'GERENTE');
INSERT INTO tbl_CARGO VALUES (NULL, 'JEFE');
INSERT INTO tbl_CARGO VALUES (NULL, 'ANALISTA');
INSERT INTO tbl_CARGO VALUES (NULL, 'TECNICO');
INSERT INTO tbl_CARGO VALUES (NULL, 'AUXILIAR');
INSERT INTO tbl_CARGO VALUES (NULL, 'PRACTICANTE');

CREATE TABLE tbl_CATEGORIAS
(
	IDE_CAT INT AUTO_INCREMENT PRIMARY KEY, -- IDE CATEGORIA
    NOM_CAT VARCHAR(20) NOT NULL,           -- NOMBRE CATEGORIA
    DES_CAT VARCHAR(80)                     -- DESCRIPCION
);
INSERT INTO tbl_CATEGORIAS VALUES (NULL, 'BEBIDAS', 'Gaseosas, cafe, te, cervezas y maltas');
INSERT INTO tbl_CATEGORIAS VALUES (NULL, 'CONDIMENTOS', 'Salsas dulces y picantes, delicias, comida para untar y aderezos');
INSERT INTO tbl_CATEGORIAS VALUES (NULL, 'REPOSTERIA', 'Postres, dulces y pan dulce');
INSERT INTO tbl_CATEGORIAS VALUES (NULL, 'LACTEOS', 'Quesos, mantequillas');
INSERT INTO tbl_CATEGORIAS VALUES (NULL, 'GRANOS', 'Pan, galletas, pasta y cereales');

CREATE TABLE tbl_USUARIO
(
    IDE_USU INT AUTO_INCREMENT PRIMARY KEY NOT NULL, -- IDE USUARIO
    CLA_USU VARCHAR(10) NOT NULL,                    -- CLAVE
    NOM_USU VARCHAR(35) NOT NULL,                    -- NOMBRES
    APE_USU VARCHAR(35) NOT NULL,                    -- APELLIDOS
    FNA_USU DATE NOT NULL,                           -- FECHA DE NACIMIENTO
    TEL_USU VARCHAR(9) NOT NULL,                     -- TELEFONO
    IDE_TDO INT NOT NULL,                            -- IDE TIPO DOCUMENTO IDENTIDAD
    NDI_USU VARCHAR(15) NOT NULL,                    -- NRO DE DOCUMENTO
    EMA_USU VARCHAR(50),                             -- CORREO ELECTRONICO
    IDE_TUS INT NOT NULL,                            -- IDE TIPO USUARIO
    FOREIGN KEY (IDE_TDO) REFERENCES tbl_TIPO_DOCUMENTO(IDE_TDO),
    FOREIGN KEY (IDE_TUS) REFERENCES tbl_TIPO_USUARIO(IDE_TUS)
);
INSERT INTO tbl_USUARIO VALUES (NULL, 'admin', 'FELIX', 'CORTEZ', '1975-05-16', '939383393', 1, '25792440', 'felix@mail.com', 1);
INSERT INTO tbl_USUARIO VALUES (NULL, 'admin', 'JOSE', 'RAMIREZ', '2000-01-01', '999888777', 1, '12345678', 'jose@mail.com', 1);
INSERT INTO tbl_USUARIO VALUES (NULL, 'admin', 'PIERRE', 'MEDINA', '2000-01-01', '999888777', 1, '12345678', 'pierre@mail.com', 1);

CREATE TABLE tbl_PROVEEDOR
(
	IDE_PRV INT AUTO_INCREMENT PRIMARY KEY, -- IDE PROVEEDOR
    RUC_PRV CHAR(11) NOT NULL,              -- RUC PROVEEDOR
	NOM_PRV VARCHAR(40) NOT NULL,           -- RAZON SOCIAL
    PCO_PRV VARCHAR(40),                    -- PERSONA DE CONTACTO
    IDE_CAR INT NOT NULL,                   -- CARGO PERSONA DE CONTACTO
    TEL_PRV VARCHAR(10) NOT NULL,           -- TELEFONO
    EMA_PRV VARCHAR(50),                    -- CORREO ELECTRONICO
    DIR_PRV VARCHAR(100),                   -- DIRECCION CLIENTE
    IDE_UBI  CHAR(6),                       -- UBIGEO
    FOREIGN KEY (IDE_CAR) REFERENCES tbl_CARGO(IDE_CAR),
    FOREIGN KEY (IDE_UBI) REFERENCES tbl_UBIGEO(IDE_UBI)
);

CREATE TABLE tbl_CLIENTE
(
	IDE_CLI INT AUTO_INCREMENT PRIMARY KEY,                     -- IDE CLIENTE
    NOM_CLI VARCHAR(50) NOT NULL,                               -- NOMBRE COMPLETO / RAZON SOCIAL
    TEL_CLI VARCHAR(9) NOT NULL,                                -- TELEFONO
    FNA_CLI DATE DEFAULT (CURRENT_DATE),                        -- FECHA DE NACIMIENTO
    SEX_CLI CHAR(1) CHECK (SEX_CLI IN ('F','M','X')) NOT NULL,  -- GENERO
    NRO_DOC VARCHAR(11),                                        -- NRO DE DOCUMENTO / RUC
    EMA_CLI VARCHAR(50),                                        -- CORREO ELECTRONICO
    DIR_CLI VARCHAR(100),                                       -- DIRECCION CLIENTE
    IDE_UBI CHAR(6),                                            -- UBIGEO
    FOREIGN KEY (IDE_UBI) REFERENCES tbl_UBIGEO(IDE_UBI)
);

CREATE TABLE tbl_PRODUCTO
(
	IDE_PRO INT AUTO_INCREMENT PRIMARY KEY, -- IDE PRODUCTO
    DES_PRO VARCHAR(50) NOT NULL,           -- DESCRIPCION
    IDE_CAT INT NOT NULL,                   -- IDE CATEGORIA
    IDE_PRV INT NOT NULL,                   -- IDE PROVEEDOR
	STK_PRO INT NOT NULL,                   -- STOCK
    PRE_PRO DECIMAL(10,2) NOT NULL,         -- PRECIO
    IDE_UME INT,                            -- UNIDAD DE MEDIDA
    VIG_PRO DATE NOT NULL,                  -- VIGENCIA DEL PRODUCTO
    FOREIGN KEY (IDE_CAT) REFERENCES tbl_CATEGORIAS(IDE_CAT),
    FOREIGN KEY (IDE_PRV) REFERENCES tbl_PROVEEDOR(IDE_PRV),
    FOREIGN KEY (IDE_UME) REFERENCES tbl_UNIDAD_MEDIDA(IDE_UME)
);

CREATE TABLE tbl_VENTA
(
	IDE_VEN INT AUTO_INCREMENT PRIMARY KEY, -- IDE VENTA
    IDE_CLI INT NOT NULL,                   -- IDE CLIENTE
    IDE_USU INT NOT NULL,                   -- IDE USUARIO
    IDE_TCO INT NOT NULL,                   -- TIPO DE COMPROBANTE
    NUM_COM INT NOT NULL,                   -- NUM. DE COMPROBANTE
    IDE_TPA INT NOT NULL,                   -- TIPO DE PAGO
    IDE_TEN INT NOT NULL,                   -- TIPO DE ENTREGA
    FEC_VEN DATE,                           -- FECHA DE VENTA
    FEC_ENT DATE,                           -- FECHA DE ENTREGA
    DIR_ENT VARCHAR(100),                   -- DIRECCION VENTA/ENTREGA
    IDE_UBI CHAR(6),                        -- UBIGEO
    PER_CON VARCHAR(30),                    -- PERSONA DE CONTACTO
    TOT_VEN DECIMAL(10,2) NOT NULL,         -- TOTAL VENTA INC. IGV
    FOREIGN KEY (IDE_CLI) REFERENCES tbl_CLIENTE(IDE_CLI),
    FOREIGN KEY (IDE_USU) REFERENCES tbl_USUARIO(IDE_USU),
    FOREIGN KEY (IDE_TCO) REFERENCES tbl_TIPO_COMPROBANTE(IDE_TCO),
    FOREIGN KEY (IDE_UBI) REFERENCES tbl_UBIGEO(IDE_UBI),
    FOREIGN KEY (IDE_TPA) REFERENCES tbl_TIPO_PAGO(IDE_TPA),
    FOREIGN KEY (IDE_TEN) REFERENCES tbl_TIPO_ENTREGA(IDE_TEN)
);

CREATE TABLE tbl_DETALLE_VENTA
(
	IDE_DVE INT AUTO_INCREMENT PRIMARY KEY, -- IDE DETALLE DE VENTA
    IDE_VEN INT NOT NULL,                   -- IDE VENTA
    IDE_PRO INT NOT NULL,                   -- IDE PRODUCTO
    CAN_VEN INT NOT NULL,                   -- CANTIDAD VENDIDA
    PRE_VEN DECIMAL(10,2) NOT NULL,         -- PRECIO UNITARIO
    DSC_VEN DECIMAL(10,2) NOT NULL,         -- DESCUENTO
    IMP_VEN DECIMAL(10,2) NOT NULL,         -- IMPORTE VENTA
    FOREIGN KEY (IDE_VEN) REFERENCES tbl_VENTA(IDE_VEN),
    FOREIGN KEY (IDE_PRO) REFERENCES tbl_PRODUCTO(IDE_PRO)
);

-- ************************************************************************************** --
